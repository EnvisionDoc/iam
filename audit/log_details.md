# Event Log Schema

This article describes the schema of the event log.


## Sample Code
```
{
  "userIdentity": {
    "userId": "u15420087818641",
    "userName": "db001",
    "type": "userAccount",
    "accessKey": null,
    "sessionContext": {
      "id": "IAM_S_e6huGLv6FMUW7KCNYZ28zuPML7Uwzg8d",
      "creationDate": "2018-11-20 10:04:20",
      "mfaAuthenticated": false
    }
  },
  "organizationId": "o15420087814661",
  "sourceIpAddress": "172.20.17.248",
  "eventTime": "2018-11-20 10:04:20",
  "eventId": "signInSelectOrganization15427082605511",
  "eventName": "signInSelectOrganization",
  "eventType": "consoleAction",
  "eventVersion": "V1.0",
  "resources": [
    {consoleSignIn
      "resourceId": "u15420087818641",
      "resourceName": "db001",
      "resourceType": "user"
    },
    {
      "resourceId": "o15420087814661",
      "resourceName": "db001",
      "resourceType": "organization"
    }
  ],
  "serviceName": "IAM-Service",
  "requestId": null,
  "requestParameters": "{\"sessionId\":\"IAM_S_e6huGLv6FMUW7KCNYZ28zuPML7Uwzg8d\",\"workingOrganizationId\":\"o15420087814661\",\"organizationId\":\"o15420087814661\"}",
  "apiVersion": null,
  "errorCode": null,
  "errorMsg": null
}
```

## Property Descriptions

- **UserIdentity**: The information of the actor of this event.
  + **type**: The account type of this user. <!--Currently only has account type _userAccount_.-->
  + **userId**: The unique identifier of the user.
  + **userName**: The username of the user.
  + **sessionContext**: The session information of this event. A session is created when the user starts to perform operations in the EnOS Console. A session has the following information:
    - **id**: The unique identifier of this session.
    - **creationDate**: The data and time when the session is created.
    - **mfAuthentication**: Indicates whether MFA is enabled when the user logs in to the EnOS Console.
- **sourceIpAddress**：The source IP address of the API request. If the API request is sent from the EnOS Console, the source IP address is the IP address of the user's browser.
- **eventTime**： The timestamp of the API request, in UTC format.
- **eventId**: The unique identifier of the event that is generated by the auditing service.  
- **eventName**：The action of the event. For more information of the event name, see [Event names](#event_types).
- **eventType**： The category of the event. Such as, ConsoleSignIn, ConsoleSignOut, and ApiCall.
- **eventVersion**：The version of the event format.
- **resource**：The resource that the action is performed against.
  + **resourceId**:  The identifier of the resource.  
  + **resourceName**: The name of the resource.
  + **resourceType**: The type of the resource. Such as, Policy, user, and UserGroup.

- **serviceName**： The service that the API belongs to. Such as, IAM.
- **requestId**：The identifier of the API request.
- **requestParameters**：The input parameters of the API request.
- **apiVersion**： The version of the invoked API.
- **responseElements**：Response message. Such as, action succeeded or failed.
- **errorCode**：The error code of the API request。
- **errorMessage**： The error message that is return against the API request.

## Event Types

The values returned for **eventName** are listed as follows.

<table>
  <tr>
    <th>Event Name</th>
    <th>Action</th>
  </tr>
  <tr>
    <td>consoleSignIn</td>
    <td>Log in to the EnOS Console</td>
  </tr>
  <tr>
    <td>consoleSignOut</td>
    <td>Log out from the EnOS Console</td>
  </tr>
  <tr>
    <td>signInSelectOrganization</td>
    <td>Select an organization when log on to the EnOS console</td>
  </tr>
  <tr>
    <td>createUser</td>
    <td>Create a user</td>
  </tr>
  <tr>
    <td>deleteUser</td>
    <td>Delete a user</td>
  </tr>
  <tr>
    <td>resetUserPassword</td>
    <td>User password is reset by the OU administration</td>
  </tr>
  <tr>
    <td>modifyUserPassword </td>
    <td>Password is modified by the account owner</td>
  </tr>
  <tr>
    <td>retrieveUserPassword</td>
    <td>User password is retrieved by the account owner</td>
  </tr>
  <tr>
    <td>setUserAccountStatus</td>
    <td>Enable or disable the user account by the OU administration</td>
  </tr>
  <tr>
    <td>addExternalUser</td>
    <td>Import an external user</td>
  </tr>
  <tr>
    <td>removeExternalUser</td>
    <td>Remove an external user</td>
  </tr>
  <tr>
    <td>createGroup</td>
    <td>Create a user</td>
  </tr>
  <tr>
    <td>deleteGroup</td>
    <td>Delete a user group</td>
  </tr>
  <tr>
    <td>addUserToGroup</td>
    <td>Add a user to a group</td>
  </tr>
  <tr>
    <td>removeUserFromGroup</td>
    <td>Remove a user from a group</td>
  </tr>
  <tr>
    <td>createPolicy</td>
    <td>Create a policy</td>
  </tr>
  <tr>
    <td>deletePolicy</td>
    <td>Delete a policy</td>
  </tr>
  <tr>
    <td>appendResource</td>
    <td>Attach services to a policy</td>
  </tr>
  <tr>
    <td>revokeResource</td>
    <td>Revoke services from a policy</td>
  </tr>
  <tr>
    <td>grantPolicy</td>
    <td>Associate a policy to a user or a group</td>
  </tr>
  <tr>
    <td>removePolicy</td>
    <td>Remove a policy from a user or a group</td>
  </tr>
</table>
